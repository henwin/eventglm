This is a resubmission to fix errors in the CRAN checks on solaris. 

- I reproduced the errors using the solaris platforms on Rhub
- Updated the tests to correctly compare floating point numbers (sorry!)
- Confirmed that the check passes on solaris using Rhub (R-release and R-release Oracle developer studio 12.6)
